<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SHOP QUAN AO</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Animate.css -->
    <link rel="stylesheet" th:href="@{/client/css/animate.css}">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" th:href="@{/client/css/icomoon.css}">
    <!-- Bootstrap  -->
    <link rel="stylesheet" th:href="@{/client/css/bootstrap.css}">

    <!-- Magnific Popup -->
    <link rel="stylesheet" th:href="@{/client/css/magnific-popup.css}">

    <!-- Flexslider  -->
    <link rel="stylesheet" th:href="@{/client/css/flexslider.css}">

    <!-- Theme style  -->
    <link rel="stylesheet" th:href="@{/client/css/style.css}">
    <link rel="stylesheet" th:href="@{/client/css/custome.css}">



</head>

<body>

<!--    header-->
<div th:replace="client/fragments/header"></div>
<!-- /.navbar -->

<!-- main -->
<div class="colorlib-shop">
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-md-push-3">
                <div class="row row-pb-lg" id="replace_hold">
                    <div class="col-md-4 text-center" th:each="product: ${product}" id="insertProduct">
                        <div class="product-entry">
                            <div class="product-img" th:style="'background-image: url(' + ${product.logo} + ');'">

                                <div class="cart">
                                    <p>
												<span class="addtocart"><a href="cart.html"><i
                                                        class="icon-shopping-cart"></i></a></span>
                                        <span><a th:href="'http://localhost:8080/store/product?id='+${product.id}"><i class="icon-eye"></i></a></span>
                                    </p>
                                </div>
                            </div>
                            <div class="desc">
                                <h3><a href="detail.html" th:text="${product.name}"></a></h3>
                                <p class="price"><span th:text="${product.price}"></span></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <ul class="pagination">
                            <li><a href="" id="left">&laquo;</a></li>
                            <li><a href="/store?page=0">1</a></li>
                            <li><a href="/store?page=1">2</a></li>
                            <li><a href="/store?page=2">3</a></li>
                            <li><a href="/store?page=3">4</a></li>
                            <li><a href="" id="right">&raquo;</a></li>
                        </ul>
                    </div>
                </div>
            </div>
<!--            <div th:replace="client/fragments/sidebar"></div>-->
            <div class="col-md-3 col-md-pull-9">
                <div class="sidebar">
                    <div class="side">
                        <h2>Danh mục</h2>
                        <div class="fancy-collapse-panel">
                            <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                                <div class="panel panel-default">
                                    <div class="panel-heading" role="tab" id="headingOne">
                                        <h4 class="panel-title" th:each="category: ${category}">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#menu1"
                                               aria-expanded="true" aria-controls="collapseOne" th:text="${category.name}"
                                               th:value="${category.id}">
                                            </a>
                                        </h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="side">
                        <h2>Khoảng giá</h2>
                        <form method="post" class="colorlib-form-2">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="guests">Từ:</label>
                                        <div class="form-field">
                                            <i class="icon icon-arrow-down3"></i>
                                            <select name="start" id="people" class="form-control">
                                                <option value="#">100.000 VNĐ</option>
                                                <option value="#">200.000 VNĐ</option>
                                                <option value="#">300.000 VNĐ</option>
                                                <option value="#">500.000 VNĐ</option>
                                                <option value="#">1.000.000 VNĐ</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="guests">Đến:</label>
                                        <div class="form-field">
                                            <i class="icon icon-arrow-down3"></i>
                                            <select name="end" id="people" class="form-control">
                                                <option value="#">2.000.000 VNĐ</option>
                                                <option value="#">4.000.000 VNĐ</option>
                                                <option value="#">6.000.000 VNĐ</option>
                                                <option value="#">8.000.000 VNĐ</option>
                                                <option value="#">10.000.000 VNĐ</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" style="width: 100%;border: none;height: 40px;">Tìm
                                kiếm</button>
                        </form>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<!-- end main -->
<!-- end main -->
<!--    footer-->
<div th:replace="client/fragments/footer"></div>
</div>

<!-- jQuery -->
<script th:src="@{/client/js/jquery.min.js}"></script>
<!-- jQuery Easing -->
<script th:src="@{/client/js/jquery.easing.1.3.js}"></script>
<!-- Bootstrap -->
<script th:src="@{/client/js/bootstrap.min.js}"></script>
<!-- Waypoints -->
<script th:src="@{/client/js/jquery.waypoints.min.js}"></script>
<!-- Flexslider -->
<script th:src="@{/client/js/jquery.flexslider-min.js}"></script>

<script th:src="@{/client/js/owl.carousel.min.js}"></script>
<!-- Magnific Popup -->
<script th:src="@{/client/js/jquery.magnific-popup.min.js}"></script>
<script th:src="@{/client/js/magnific-popup-options.js}"></script>

<!-- Stellar Parallax -->
<script th:src="@{/client/js/jquery.stellar.min.js}"></script>
<!-- Main -->
<script th:src="@{/client/js/main.js}"></script>

<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
    // $.widget.bridge('uibutton', $.ui.button)

    var url_string = window.location.href; //window.location.href
    var url = new URL(url_string);
    var page = url.searchParams.get("page")
    if(page == null){
        page = 0
    } else {
        page = parseInt(page)
    }
    $(document).ready(function () {
        $("#left").click(function (){
            let pageLeft = page - 1
            console.log(left)
            $("#left").attr('href', "/store?page="+pageLeft)
        })

        $("#right").click(function (){
            let pageRight = parseInt(page) + 1
            console.log(right)
            $("#right").attr('href', "/store?page="+pageRight)
        })

        $(".panel-title > a").click(function () {
            var aValue = this.getAttribute('value')
            $.ajax({
                type: 'GET',
                url: "http://localhost:8080/product-api?id="+aValue,
                success: function (response) {
                    $("#replace_hold > div").remove()
                    response.forEach(data => {
                        $("#replace_hold").append("  <div class=\"col-md-4 text-center\">\n" +
                            "                        <div class=\"product-entry\">\n" +
                            "                            <div class=\"product-img\" th:style=\"'background-image: url(' "+data.logo+" ');'\">\n" +
                            "\n" +
                            "                                <div class=\"cart\">\n" +
                            "                                    <p>\n" +
                            "\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"addtocart\"><a href=\"cart.html\"><i\n" +
                            "                                                        class=\"icon-shopping-cart\"></i></a></span>\n" +
                            "                                        <span><a href=\"detail.html\"><i class=\"icon-eye\"></i></a></span>\n" +
                            "                                    </p>\n" +
                            "                                </div>\n" +
                            "                            </div>\n" +
                            "                            <div class=\"desc\">\n" +
                            "                                <h3><a href=\"detail.html\" th:text=\""+data.name+"\"></a></h3>\n" +
                            "                                <p class=\"price\"><span th:text=\""+data.price+"\"></span></p>\n" +
                            "                            </div>\n" +
                            "                        </div>\n" +
                            "                    </div>")
                    })

                }
            })
        })
    })


</script>

<!--<script src="http://code.jquery.com/jquery-1.9.1.js"></script>-->
<script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>

</body>

</html>